{% extends "psf/full-width.html" %}
{% load boxes %}

{% block page_title %}Sponsorship Application | {{ SITE_INFO.site_name }}{% endblock %}

{% block content %}

    <article id="sponsorship_application_container" class="text">
        <h1>Sponsorship Application</h1>

        <form id="application_form" action="." method="POST">
          {% csrf_token %}

          {% if form.errors %}
            {{ form.non_field_errors }}
          {% endif %}

          <div id="package_selection">
          {{ form.package }}
          </div>

          <div id="cost_container" calculate_cost_url="{% url 'new_sponsorship_application_price_calc' %}">
            <span id="cost_label">Select a package or customize the benefits</span>
          </div>

          <div id="clear_form_btn">
          <button type="button" name="clear">Clear Selections</button>
          </div>

          <div id="benefits_container">
          {% for field in form.benefits_programs %}
            <div class="benefits_checkboxes">
            <h3 class="title">{{ field.label }}</h3>

            <ul id="id_{{ field.name }}">
            {% for benefit in field.field.queryset %}
                <li class="{% cycle '' 'highlight' %}">
                    <label for="id_{{field.name}}_{{ forloop.counter0 }}" title="{{ benefit.unavailability_message }}">
                        <input id="id_{{field.name}}_{{ forloop.counter0 }}" name="{{ field.name }}" type="checkbox" value="{{ benefit.id }}" {% if benefit.unavailability_message %}disabled{% endif %}>{{ benefit.name }}
                    </label>
                </li>
            {% endfor %}
            {% resetcycle %}
            </ul>

            </div>
          {% endfor %}
          </div>

          <input type="submit" value="Submit">
          </div>
        </form>
    </article>

    <div id="package_benefits" style="display: none">
    {% for package, benefits in form.benefits_by_package.items %}
      <div id="package_benefits_{{ package }}">
        {% for benefit in benefits %}
          <div>{{ benefit }}</div>
        {% endfor %}
      </div>

    {% endfor %}
    </div>

    <div id="conflicts_container" style="display: none">
    {% for benefit, conflicts in form.benefits_conflicts.items %}
      <div id="conflicts_with_{{ benefit }}">
        {% for conflict in conflicts %}
          <div>{{ conflict }}</div>
        {% endfor %}
      </div>
    {% endfor %}
    </div>
{% endblock content %}

{% block javascript %}
  {{ block.super }}
  <script src="{{ STATIC_URL }}js/sponsors/applicationForm.js"></script>
{% endblock %}
